(function(t,i,o,a){jQuery(o).ready(function(t){function a(t,n,i,o,a){var e,s,c;o&&(n+="px",i+="px",e="translate3D("+n+","+i+" , 0)",s={},c=r(),s[c+"transform"]=e,s[c+"transition"]=c+"transform 0s linear",s.cursor=a,"null"==o&&(s[c+"transform"]="",s[c+"transition"]=""),t.css(s))}function r(){var t=o.body||o.documentElement;return t=t.style,""==t.WebkitTransition?"-webkit-":""==t.MozTransition?"-moz-":""==t.OTransition?"-o-":""==t.transition?"":void 0}function e(n,i,o,a,r){var e=n.parents(".ajax-form,ajaxform"),s=e.find(".ajax-notice"),c=n.html(),d=e.attr("ajax-url")||n.attr("href"),l='<i class="fa fa-spinner fa-spin fa-fw"></i> ',u="warning",f=l+"正在处理，请稍候...";n.attr("disabled",!0).html(l+"请稍候..."),a&&(s.html('<div style="padding: 10px;margin: 0;" class="notice"></div>'),a=l+a),s.find(".notice").html(a||f).removeClass("notice-error notice-info").addClass("notice-warning"),t.ajax({type:"POST",url:d,data:i,dataType:"json",error:function(t){n_con='<div style="padding: 10px;margin: 0;" class="notice notice-error"><b>网络异常或者操作失败，请稍候再试！ '+t.status+"|"+t.statusText+"</b></div>",s.html(n_con),n.attr("disabled",!1).removeClass("jb-blue").html("操作失败"),e.find(".progress").css("opacity",0).find(".progress-bar").css({width:"0",transition:"width .3s"})},success:function(a){a.msg&&(u=a.error_type||(a.error?"error":"info"),n_con='<div style="padding: 10px;margin: 0;" class="notice notice-'+u+'"><b>'+a.msg+"</b></div>",s.html(n_con)),n.attr("disabled",!1).html(a.button||c),a.reload&&setTimeout(function(){location.reload()},1e3),t.isFunction(o)&&o(a,n,i)}})}t.fn.minitouch=function(n){n=t.extend({direction:"bottom",selector:"",depreciation:50,onStart:!1,onEnd:!1},n);var i=t(this),o=(t("body"),n.depreciation),r=0,e=0,s=0,c=0,d=0,l=0,u=0,f=!1;i.on("touchstart pointerdown MSPointerDown",n.selector,function(t){r=0,e=0,s=0,c=0,d=0,l=0,u=0,r=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,e=t.originalEvent.pageY||t.originalEvent.touches[0].pageY,f=!0}).on("touchmove pointermove MSPointerMove",n.selector,function(i){s=i.originalEvent.pageX||i.originalEvent.touches[0].pageX,c=i.originalEvent.pageY||i.originalEvent.touches[0].pageY,l=s-r,u=c-e,d=180*Math.atan2(u,l)/Math.PI,"right"==n.direction&&(u=0,l=d>-40&&d<40&&l>0?l:0),"left"==n.direction&&(u=0,l=(d>150||d<-150)&&0>l?l:0),"top"==n.direction&&(l=0,u=d>-130&&d<-50&&0>u?u:0),"bottom"==n.direction&&(l=0,u=d>50&&d<130&&u>0?u:0),0===l&&0===u||(i.preventDefault(),a(t(this),l,u,f,"grab"))}).on("touchend touchcancel pointerup MSPointerUp",n.selector,function(m){(Math.abs(l)>o||Math.abs(u)>o)&&0!=n.onEnd&&n.onEnd(i),a(t(this),0,0,"null",""),f=!1,r=0,e=0,s=0,c=0,d=0,l=0,u=0})},t("body").on("click",".ajax-get",function(){var n=t(this),i=n.attr("data-confirm");return i?1==confirm(i)&&(e(n,{}),!1):(e(n,{}),!1)}),t("body").on("click",".online-update",function(){var n={},i=t(this),o=i.parents(".ajax-form").find(".progress");if(i.attr("disabled"))return!1;n.action="zibll_online_update",e(i,n,function(t){a(t)},"正在获取更新文件，请稍候...");var a=function(t){t.error?(i.attr("disabled",!1).html('<i class="fa fa-cloud-download fa-fw"></i> 在线更新').siblings(".ajax-submit").fadeIn(150),o.css("opacity",0).find(".progress-bar").css({width:"0",transition:"width .3s"})):(t.action&&(n=t,e(i,n,function(t){a(t)},t.msg)),t.progress&&(i.attr("disabled",!0).siblings(".ajax-submit").fadeOut(150),o.css("opacity",1),o.find(".progress-bar").css({width:t.progress+"%",transition:"width .5s"})),t.progress_end&&t.progress_time&&setTimeout(function(){o.find(".progress-bar").css({width:t.progress_end+"%",transition:"width "+t.progress_time+"s"})},500))}}),t("body").on("click",".ajax-submit",function(){var i={},o=t(this),a=o.parents(".ajax-form");if(o.attr("disabled"))return!1;a.find("input,[ajax-name],[name]").each(function(){n=t(this).attr("ajax-name")||t(this).attr("name"),v=t(this).val(),n&&(i[n]=v)});var r="authorization_submit"==o.attr("id");return e(o,i,function(t){t.error&&r&&(_tt="开启正版授权",a.find(".hide-box").slideDown(300))})}),t(i).on("scroll resize",function(){var n=o.documentElement.scrollTop+o.body.scrollTop,i=t(".csf-container");n>300?i.addClass("sticky-sm"):i.removeClass("sticky-sm")});var s=t(i).width();t(o).on("click",".csf-menu",function(n){t(".csf-nav-options").toggleClass("show")}),t(o).on("click",".remove-readonly",function(n){var i=t(this).attr("readonly-id");t("[data-readonly-id="+i+"]").attr("readonly",!1).focus(),t(this).slideUp(200)}),s<783&&t(".csf-nav-options").minitouch({direction:"right",onEnd:function(t){t.removeClass("show")}})})})(jQuery,window,document);